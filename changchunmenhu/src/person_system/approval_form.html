<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>审批表</title>
    <script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>
    <script src="./js/jquery.pagination.js"></script>
    <script src="./js/layout.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <script src="./js/date_formate.js"></script>
    <link rel="stylesheet" href="./css/pagination.css">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="icon" href="./img/favicon.ico" />
</head>
<body>
<header class="clearfix pr">
    <div class="fl logo col-lg-3 col-sm-4 col-xs-8">
        <img src="./img/main/LOGO.png" alt="">
    </div>
    <div class="fl search col-lg-7 col-sm-6 col-xs-12">
        <img src="./img/main/btn_search.png" alt="" class="search_btn">
        <input type="text" id="keyWord" placeholder="可按公司、部门、职务、姓名查询">
    </div>
    <div class="fl logout col-lg-2 col-sm-2 col-xs-12">
        <button onclick="window.location.href='./login.html'"><img src="./img/main/btn_exit.png" alt=""></button>
    </div>
     
    <div class="humber_nav">
        <img src="./img/main/humber_nav.svg" alt="">
    </div>
</header>
<div class="main">
    <img src="./img/main/to_close.png" alt="" class="left_menu_control">
    <div class="left col-lg-2 col-sm-3" id="leftMenu">

        <div class="user_info_area">
            <div class="avator">
                <img src="./img/main/chart_01.png" alt="">
            </div>
            <div class="user_name">用户名</div>
            <div class="job_title">职务名称</div>
        </div>
        <div class="s-side">
            <ul>
                <li class="first">
                    <div class="d-firstNav s-firstNav clearfix">
                        <i class="fa fa-bars fa-caret fa-add-icon"></i>
                        <span>集团本部</span>
                        <i class="fa fa-caret-right fr "></i>
                    </div>
                    <ul class="d-firsthrop s-firsthrop">
                        <li class="s-secondItem">
                            <a href="./index.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>人员花名册</span>
                            </a>
                        </li>
                        <li class="s-secondItem">
                            <a href="./approval_form.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>干部任免审批表</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="first">
                    <div class="d-firstNav s-firstNav">
                        <i class="fa fa-bars fa-caret fa-add-icon"></i>
                        <span>集团部门正职级以上</span>
                        <i class="fa fa-caret-right fr"></i>
                    </div>
                    <ul class="d-firsthrop s-firsthrop">
                        <li class="s-secondItem">
                            <a href="./index.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>人员花名册</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="first">
                    <div class="d-firstNav s-firstNav">
                        <i class="fa fa-bars fa-caret"></i>
                        <span>集团部门副职级以上</span>
                        <i class="fa fa-caret-right fr"></i>
                    </div>
                    <ul class="d-firsthrop s-firsthrop" style="display: block">
                        <li class="s-secondItem">
                            <a href="./index.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>人员花名册</span>
                            </a>
                        </li>
                        <li class="s-secondItem choosed">
                            <a href="./approval_form.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>干部任免审批表</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="first">
                    <div class="d-firstNav s-firstNav">
                        <i class="fa fa-bars fa-caret fa-add-icon"></i>
                        <span>下属公司中层正职</span>
                        <i class="fa fa-caret-right fr"></i>
                    </div>
                    <ul class="d-firsthrop s-firsthrop">
                        <li class="s-secondItem">
                            <a href="./index.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>人员花名册</span>
                            </a>
                        </li>
                        <li class="s-secondItem">
                            <a href="./approval_form.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>企业干部信息登记表</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="first">
                    <div class="d-firstNav s-firstNav">
                        <i class="fa fa-bars fa-caret fa-add-icon"></i>
                        <span>下属公司中层副职以上</span>
                        <i class="fa fa-caret-right fr"></i>
                    </div>
                    <ul class="d-firsthrop s-firsthrop">
                        <li class="s-secondItem">
                            <a href="./index.html">
                                <i class="fa fa-minus-square-o"></i>
                                <span>人员花名册</span>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
    <div class="right col-lg-10  col-sm-9" id="rightContent">
        <div class="form_area row">
            <div class="col-lg-4 col-sm-4">
                <span>公司：</span>
                <select class="form-control" id="company">
                    <option>广州市城投环境能源投资管理有限公司</option>
                </select>
            </div>
            <div class="col-lg-2 col-sm-4">
                <span>部门：</span>
                <select class="form-control" id="apartment">
                    <option>副三总师</option>
                </select>
            </div>
            <div class="col-lg-2 col-sm-4">
                <span>职务：</span>
                <select class="form-control" id="job">
                    <option>技术总监</option>
                </select>
            </div>
            <div class="col-lg-2 col-sm-4">
                <span>姓名：</span>
                <select class="form-control" id="name">
                    <option>曾水根</option>
                </select>
            </div>
            <div class="btn_area hide col-lg-2 col-sm-8" style="text-align: ;">
                <div class="fl" id="listModel"></div>
                <div class="fl layout_btn_choosed" id="cardModel"></div>
            </div>
            <div class="date_area col-lg-2 col-sm-8">
                <p>填表时间</p>
                <p class="time"></p>
            </div>
        </div>
        <div class="table_area table-responsive">
            <table class="table table-hover table-striped  table-bordered">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>姓名</th>
                    <th>性别</th>
                    <th>民族</th>
                    <th>出生<br>年月</th>
                    <th>籍贯</th>
                    <th>学位<br>学历</th>
                    <th>毕业<br>院校</th>
                    <th>所学<br>专业</th>
                    <th>现任<br>职务</th>
                    <th>任现职<br>时间</th>
                    <th>任现职<br>级时间</th>
                    <th>专业技<br>术职称</th>
                    <th>备注</th>
                    <th>拟任职务</th>
                    <th class="col-xs-4 col-sm-1 col-lg-1">状态</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>01</td>
                    <td>2121</td>
                    <td>男</td>
                    <td>汗</td>
                    <td>1994-09-11</td>
                    <td>广州</td>
                    <td>大学学士</td>
                    <td>广州中医药大学</td>
                    <td>中医</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td>2017.08h</td>
                    <td>2009.03</td>
                    <td>无</td>
                    <td>中层正职</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td class="status"><a class="allow" href="javascript:;">通过</a></td>

                </tr>
                <tr>
                    <td>01</td>
                    <td>2121</td>
                    <td>男</td>
                    <td>汗</td>
                    <td>1994-09-11</td>
                    <td>广州</td>
                    <td>大学学士</td>
                    <td>广州中医药大学</td>
                    <td>中医</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td>2017.08h</td>
                    <td>2009.03</td>
                    <td>无</td>
                    <td>中层正职</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td class="status"><a class="reject" href="javascript:;">驳回</a></td>
                </tr>
                <tr>
                    <td>01</td>
                    <td>2121</td>
                    <td>男</td>
                    <td>汗</td>
                    <td>1994-09-11</td>
                    <td>广州</td>
                    <td>大学学士</td>
                    <td>广州中医药大学</td>
                    <td>中医</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td>2017.08h</td>
                    <td>2009.03</td>
                    <td>无</td>
                    <td>中层正职</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td class="status"><a class="checking" href="javascript:;">审核</a></td>
                </tr>
                <tr>
                    <td>01</td>
                    <td>2121</td>
                    <td>男</td>
                    <td>汗</td>
                    <td>1994-09-11</td>
                    <td>广州</td>
                    <td>大学学士</td>
                    <td>广州中医药大学</td>
                    <td>中医</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td>2017.08h</td>
                    <td>2009.03</td>
                    <td>无</td>
                    <td>中层正职</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td class="status"><a class="checking" href="javascript:;">审核</a></td>
                </tr>
                <tr>
                    <td>01</td>
                    <td>2121</td>
                    <td>男</td>
                    <td>汗</td>
                    <td>1994-09-11</td>
                    <td>广州</td>
                    <td>大学学士</td>
                    <td>广州中医药大学</td>
                    <td>中医</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td>2017.08h</td>
                    <td>2009.03</td>
                    <td>无</td>
                    <td>中层正职</td>
                    <td>集团党委委员<br>
                        纪委副书记
                    </td>
                    <td class="status"><a class="checking" href="javascript:;">审核</a></td>
                </tr>
                </tbody>
            </table>

            <div class="panigation col-lg-12 col-sm-12 col-xs-12">
                <div class="m_style panigation_wrap1"></div>
            </div>
        </div>
    </div>
</div>
<div class="hide">
    <img src="./img/main/btn_list.png" alt="">
    <img src="./img/main/btn_menu.png" alt="">
</div>
<!-- 模态框（Modal） -->
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true"><img
                        src="./img/main/btn_close.png" alt="" width="23px"></span></button>
                <button type="button" class="edit fr" id="refuse"><span aria-hidden="true"><img
                        src="./img/main/btn_refuse.png" alt="" width="24px"></span></button>
                <button type="button" class="edit fr" id="pass"><span aria-hidden="true"><img
                        src="./img/main/btn_pass.png" alt="" width="24px"></span></button>
                <h4 class="modal-title" id="myModalLabel">干部任免审批表</h4>
            </div>
            <div class="modal-body">
                <div id="pdf">
                    <iframe src="" id="pdfContainer" frameborder="0" name="pdfContainer"></iframe>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary">保存</button>
            </div>
        </div>
    </div>
</div>
<!-- /.modal -->

</body>
<script>
    if(window.innerWidth>=450 && window.innerWidth<=960){
        $('#leftMenu').removeClass('col-sm-3').addClass('col-sm-4')
        $('#rightContent').removeClass('col-sm-9').addClass('col-sm-8')
    }
    $('#leftMenu').css('transition', '0s')
    window.onresize = function () {
        $('#leftMenu').css('transition', '0s')
        $('#leftMenu,#rightContent').height(window.innerHeight - $('header').height());

        setTimeout(function () {
            var oldWidth = $('#leftMenu').width() + $('.left_menu_control').width()
            if (!$('.left_menu_control').hasClass('closed')) {
                $('.left_menu_control').css({
                    'left': oldWidth,
                    'transition': '-0s'
                })
            }
        })


    }
    $('#leftMenu,#rightContent').height(window.innerHeight - $('header').height())
    /*左侧导航*/
    $(function () {
        $('.d-firstNav').click(function (e) {
            $(this).parent().siblings().find('.d-firstNav span').css('color', 'rgba(255,255,255,0.60)')
            dropSwift($(this), '.d-firsthrop');
            e.stopPropagation();
        });
        $('.d-secondNav').click(function (e) {
            /*注释展开第三季*/
            /*dropSwift($(this), '.d-secondDrop');*/
            e.stopPropagation();
        });
        $('.s-secondItem').click(function (e) {
            $('#leftMenu .choosed').removeClass('choosed')
            $('.s-secondItem').find('span').removeClass('choosed')
            $(this).find('span').css('color', '#fff')
            $(this).addClass('choosed')
        })

        function dropSwift(dom, drop) {
            dom.find('span').css('color', '#fff')
            dom.next().slideToggle();
            dom.parent().siblings().find('.fa-caret').addClass('fa-add-icon');
            dom.parent().siblings().find(drop).slideUp();
            var iconChevron = dom.find('.fa-caret');
            if (iconChevron.hasClass('fa-add-icon')) {
                iconChevron.removeClass('fa-add-icon');
            } else {
                iconChevron.addClass('fa-add-icon');
            }
        }
    });
    /*左侧导航收缩*/
    var oldWidth = $('#leftMenu').width() + $('.left_menu_control').width()
    $('.left_menu_control').css('left', oldWidth)
    $('.left_menu_control').click(function () {
        var oldWidth = $('#leftMenu').width() + $('.left_menu_control').width();
        /* $('#leftMenu').css('transition','0.3s')*/
        if ($(this).hasClass('closed')) {
            $('#leftMenu').css('left', '0').show()
            $(this).removeClass('closed').css({
                'left': oldWidth,
                'transition-delay': '0'
            }).attr('src', './img/main/to_close.png')
            $('#rightContent').removeClass('col-lg-12 col-sm-12').addClass('col-lg-10 col-sm-8')
            if(window.innerWidth>=450 && window.innerWidth<=960){

                $('#leftMenu').removeClass('col-sm-3').addClass('col-sm-4')
                $('#rightMenu').removeClass('col-sm-9').addClass('col-sm-8')
            }else{
                $('#leftMenu').removeClass('col-sm-4').addClass('col-sm-3')
                $('#rightContent').removeClass('col-sm-8').addClass('col-sm-9')
            }
        } else {
            $(this).addClass('closed').css({
                'left': 0,
                'transition-delay': '-0.22s'
            }).attr('src', './img/main/to_show.png')
            $('#leftMenu').hide().css('left', '-100%')
            $('#rightContent').removeClass('col-lg-10 col-sm-8 col-sm-9').addClass('col-lg-12 col-sm-12')
        }


    });
    /*humber按钮*/
    $('.humber_nav').click(function () {
        $('#leftMenu').toggleClass('show')
    })
    /**分页*/
    var pageSize = 20
    findPageData(null, 'panigation_wrap1')

    function findPageData(page, id) {
        var params = {};
        if (page) {
            params.pageCurrent = page.getCurrent();
        } else {
            params.pageCurrent = 1;
        }
        params.pageSize = pageSize;
        params.company = $('#company').val()
        params.apartment = $('#apartment').val()
        params.job = $('#job').val()
        params.name = $('#name').val()
        console.log(params)


        var pageCount = getPageCount(1200, pageSize)
        if (!page) {
            $('.' + id).pagination({
                pageCount: pageCount,//pageCount总页数,默认为9
                jump: true,
                mode: 'fixed',
                homePage: "首",
                endPage: "末",
                coping: true, //首页和尾页
                isHide: true, //当前页数为0页或者1页时不显示分页
                callback: findPageData
            });
        }
    }

    function getPageCount(totalCount, pageSize) {
        var size = pageSize || 20;
        if (totalCount % size == 0) {
            return totalCount / size;
        } else {
            return Math.ceil(totalCount / size);
        }
    }

    /*日期格式化*/
    var formaterTime = DateUtils.formate(new Date().getTime(), 'yyyy年MM月dd日')
    $('.time').text(formaterTime)
    /**弹窗***/
    $('.checking').on('click', function () {
        //var $tr = $(this).parents('tr').eq(0);
        //var id = $tr.attr('userId') || 'mockId';
        //点击审核弹出与之对应的mask
        //initMask(id)
        initMask()
    })

    function initMask(id) {
        /*HttpUtils.post(url,param,function(res){
            pdfurl = encodeURIComponent('${request.contextPath}/source/pdf?path='+encodeURIComponent(res.data));
            var viewurl = '${request.contextPath}/static/portal/js/viewpdf/web/viewer.html?pdfurl='+pdfurl;
            $("#pdfContainer").attr("src",viewurl);
            $("#nextBtn").parent().hide();
            $('.contract').show();
        });*/
        $('#myModal').modal({})
        var pdfurl = './b.pdf'//static
        var viewurl = './js/viewpdf/web/viewer.html?pdfUrl=' + pdfurl;
        //调用微软的在线预览功能实现 (预览前提：资源必须是公共可访问的 只能预览不能编辑)
        //$("#pdfContainer").attr("src",'https://view.officeapps.live.com/op/view.aspx?src=http://storage.xuetangx.com/public_assets/xuetangx/PDF/1.xls');
        //<a href="http://www.xdocin.com/xdoc?_func=to&amp;_format=html&amp;_cache=1&amp;_xdoc=./textdoc.docx" target="_blank" rel="nofollow">XDOC</a>
        $("#pdfContainer").attr("src", viewurl);
    }

    /*点击li跳转这里用url参数来模拟判断点击了哪一个选项 从而跳转页面后对应左侧选中状态*/
    $('.d-firsthrop li a').click(function(){
        $(this).parent().click()
        return false
    })
    $('.d-firsthrop li').click(function(){
        var href = $(this).find('a').attr('href')
       /* if(location.search.indexOf('?')>-1){
            return
        }*/
        var index  = $(this).index()
        var parentIndex = $(this).parents('.first').eq(0).index()
        href += "?parentIndex="+parentIndex+"&index="+index
        window.location.href = href
    })
    function GetRequest() {
        var url = location.search; //获取url中"?"符后的字串
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            strs = str.split("&");
            for (var i = 0; i < strs.length; i++) {
                theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
            }
        }
        return theRequest;
    }
    var paramsData = GetRequest()
    if(!$.isEmptyObject(paramsData)){
        var firstChoosed = paramsData.parentIndex
        var secondChoosed = paramsData.index
        $('.d-firsthrop').hide()
        $('.first .fa-caret').addClass('fa-add-icon')
        $('.first').eq(firstChoosed).find('.fa-caret').removeClass('fa-add-icon')
        $('.first').eq(firstChoosed).find('.d-firsthrop').show()
        $('.choosed').removeClass('choosed')
        $('.first').eq(firstChoosed).find('.d-firsthrop li').eq(secondChoosed).addClass('choosed')
    }
</script>
</html>